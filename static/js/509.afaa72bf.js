(self["webpackChunkfront_vue"]=self["webpackChunkfront_vue"]||[]).push([[509],{1391:function(t,e,a){"use strict";a.d(e,{default:function(){return d}});var i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"titlel"},[[e("div",{staticClass:"titletext"},[t._t("nametext",(function(){return[t._v("投资")]}))],2)]],2)},r=[],s=a(1594),n=a.n(s),o=n(),c=a(3736),l=(0,c.Z)(o,i,r,!1,null,"39a88d78",null),d=l.exports},6509:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return k}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"safe"},[e("div",{staticClass:"maincon safebox"},[e("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"质量整改",name:"first"}},[e("ul",{staticClass:"con"},[t._l(t.lidatas,(function(i,r){return e("li",{key:r,on:{click:function(e){return t.liclick(i)}}},[e("p",{staticClass:"title"},[t._v(t._s(i.title))]),e("p",[e("span",[t._v(t._s(t._f("time")(i.createTime)))]),e("span",{staticClass:"submi",attrs:{type:"primary",size:"small"}},[t._v(t._s(i.statusDesc))])]),i.cover?t._e():e("img",{attrs:{src:a(2276),alt:""}}),i.cover?e("img",{attrs:{src:i.cover,alt:""}}):t._e()])})),e("el-pagination",{attrs:{background:"","current-page":t.currentPage,layout:"prev, pager, next, jumper","page-size":4,total:t.total},on:{"current-change":t.whatepage,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],2),e("div",{staticClass:"saferight"},[e("div",{staticClass:"bgbox-s",staticStyle:{height:"17vw"}},[e("Titles",{scopedSlots:t._u([{key:"nametext",fn:function(){return[t._v(" 类型分析 ")]},proxy:!0}])}),e("div",{ref:"chartthree",staticStyle:{height:"17vw",width:"23vw"}})],1),e("div",{staticClass:"bgbox-s",staticStyle:{height:"17vw"}},[e("Titles",{scopedSlots:t._u([{key:"nametext",fn:function(){return[t._v(" 责任人分析 ")]},proxy:!0}])}),e("div",{ref:"chartfour",staticStyle:{height:"17vw",width:"23vw"}})],1),e("div",{staticClass:"bgbox-m",staticStyle:{"margin-top":"6vw"}},[e("Titles",{scopedSlots:t._u([{key:"nametext",fn:function(){return[t._v(" 趋势分析 ")]},proxy:!0}])}),e("div",{ref:"chart",staticStyle:{height:"200px",width:"50vw"}})],1)])]),e("el-tab-pane",{attrs:{label:"安全整改",name:"second"}},[e("ul",{staticClass:"con"},[t._l(t.lidatas,(function(i,r){return e("li",{key:r,on:{click:function(e){return t.liclick(i)}}},[e("p",{staticClass:"title"},[t._v(t._s(i.title))]),e("p",[e("span",[t._v(t._s(t._f("time")(i.createTime)))]),e("span",{staticClass:"submi",attrs:{type:"primary",size:"small"}},[t._v(t._s(i.statusDesc))])]),i.cover?t._e():e("img",{attrs:{src:a(2276),alt:""}}),i.cover?e("img",{attrs:{src:i.cover,alt:""}}):t._e()])})),e("el-pagination",{attrs:{background:"","current-page":t.currentPage,layout:"prev, pager, next, jumper","page-size":4,total:t.total},on:{"current-change":t.whatepage,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],2),e("div",{staticClass:"saferight"},[e("div",{staticClass:"bgbox-m",staticStyle:{"margin-top":"20px",height:"15vw"}},[e("Titles",{scopedSlots:t._u([{key:"nametext",fn:function(){return[t._v(" 类型分析 ")]},proxy:!0}])}),e("div",{ref:"echarttotop",staticStyle:{height:"15vw",width:"50vw"}})],1),e("div",{staticClass:"bgbox-m",staticStyle:{"margin-top":"6vw",height:"15vw"}},[e("Titles",{scopedSlots:t._u([{key:"nametext",fn:function(){return[t._v(" 趋势分析 ")]},proxy:!0}])}),e("div",{ref:"echartto",staticStyle:{height:"15vw",width:"50vw"}})],1)])])],1)],1),e("Showdilog",{attrs:{havedatainfo:t.havedatainfo}})],1)},r=[],s=(a(7658),a(4471));function n(t){return(0,s.Z)({url:"/rectifies/v2/actions/classify",method:"get",params:t})}function o(t){return(0,s.Z)({url:"/rectifies/v2/actions/statAmountByMonth",method:"get",params:t})}function c(t){return(0,s.Z)({url:"/rectifies/v2/actions/statByHidDanger",method:"get",params:t})}function l(t){return(0,s.Z)({url:"/rectifies/v2/actions/statByProcessor",method:"get",params:t})}var d=a(1391),u=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.$store.state.safedilog,width:"80%"},on:{"update:visible":function(e){return t.$set(t.$store.state,"safedilog",e)}}},[e("p",{staticStyle:{"margin-bottom":"30px"}},[t._v("【"+t._s(t._f("status")(t.ruleForm.status))+"】"+t._s(t.ruleForm.title))]),e("div",{staticClass:"frommaincom"},[e("p",[t._v("处理角色："+t._s(t.ruleForm.processorDeptName))]),e("p",[t._v("负责人："+t._s(t.ruleForm.processorNick))]),e("p",[t._v("手机号："+t._s(t.ruleForm.processorPhone))]),e("p",[t._v("抄送： "),t._l(t.ruleForm.copies,(function(a,i){return e("span",{key:i},[t._v(" "+t._s(t._f("copies")(a))+" ")])}))],2)]),e("div",{staticClass:"notStartedcon"},t._l(t.ruleForm.problems,(function(a,i){return e("div",{key:a.problemId,staticClass:"addbox"},[e("p",{staticClass:"addboxtitle"},[t._v(t._s(a.title))]),e("p",[t._v(" 【"+t._s(t._f("dataType")(a.dataType))+"】隐患点："+t._s(a.hidDangerName)+" ")]),e("p",[t._v(" 内容："+t._s(a.context)+" ")]),t._l(a.images,(function(t,a){return e("img",{key:a,staticClass:"itemimage",attrs:{src:t,fit:"fill"}})})),e("table",{staticClass:"table"},[e("thead",{staticStyle:{"background-color":"#F5F5F5"}},[e("tr",[e("th",[t._v("附件")]),e("th",[t._v("上传人")]),e("th",[t._v("操作")])])]),e("tbody",{staticClass:"modalTableBody"},t._l(a.attachments,(function(a,i){return e("tr",{key:i},[e("td",[t._v("附件"+t._s(i+1)+".pdf")]),e("td",[t._v("暂无")]),e("td",[e("span",{staticClass:"vwBtn",on:{click:function(e){return t.openUrl(a)}}},[t._v("查看")])])])})),0),null==a.attachments?e("p",{staticStyle:{"text-align":"center",width:"100%",color:"#ccc"}},[t._v("无附件")]):t._e()]),t._l(a.workflows,(function(i,r){return e("div",{key:i.workflowId,staticClass:"constructionbox"},["21002"==i.processorType&&"12001"!=i.actionCode?e("div",{staticClass:"addbox",staticStyle:{width:"calc(100% - 40px)","margin-bottom":"10px"}},[e("p",{staticClass:"addboxtitle"},[t._v("施工方处理意见")]),e("p",{staticStyle:{height:"40px"}},[t._v(" 【"+t._s(1==a.dataType?"质量":"安全")+"】隐患点:"+t._s(a.hidDangerName)+" "+t._s(i.actionDesc)+" ")]),e("p",[t._v(t._s(a.workflows[r].advice))]),e("div",t._l(a.workflows[r].images,(function(t,a){return e("p",{key:a,staticClass:"block",staticStyle:{display:"inline-block"}},[e("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t,fit:"fill"}})],1)})),0),e("table",{staticClass:"table"},[e("thead",{staticStyle:{"background-color":"#F5F5F5"}},[e("tr",[e("th",[t._v("附件")]),e("th",[t._v("上传人")]),e("th",[t._v("操作")])])]),e("tbody",{staticClass:"modalTableBody"},t._l(a.workflows[r].attachments,(function(a,i){return e("tr",{key:i},[e("td",[t._v("附件"+t._s(i+1)+".pdf")]),e("td",[t._v("暂无")]),e("td",[e("span",[t._v("查看")])])])})),0),null==a.workflows[r].attachments?e("p",{staticStyle:{"text-align":"center",width:"100%",color:"#ccc"}},[t._v("无附件")]):t._e()])]):t._e(),"21003"==i.processorType&&"12001"!=i.actionCode?e("div",{staticClass:"addbox",staticStyle:{width:"calc(100% - 40px)","margin-bottom":"10px"}},[e("p",{staticClass:"addboxtitle"},[t._v("监理方意见")]),e("div",{staticClass:"main"},[e("p",{domProps:{innerHTML:t._s(i.advice)}})])]):t._e(),"21001"==i.processorType&&"12001"!=i.actionCode?e("div",{staticClass:"addbox",staticStyle:{width:"calc(100% - 40px)","margin-bottom":"10px"}},[e("p",{staticClass:"addboxtitle"},[t._v("业主方意见")]),e("div",{staticClass:"main"},[e("p",{domProps:{innerHTML:t._s(i.advice)}})])]):t._e()])}))],2)})),0),e("span",{staticClass:"dialog-footer",staticStyle:{"text-align":"center",display:"block"},attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.expo}},[t._v("导出")]),e("el-button",{on:{click:function(e){t.$store.state.safedilog=!1}}},[t._v("关闭")])],1)])},f=[],h=a(7578),p=a(4720),m={props:["havedatainfo"],inject:["reload"],filters:{copies(t){return 21001==t?"业主":21002==t?"施工":21003==t?"监理":21004==t?"交通局":""},status(t){return 10003==t?"已关闭":1e4==t?"未开始":10001==t?"进行中":void 0},dataType(t){return 1==t?"质量":2==t?"安全":void 0}},components:{},data(){return{initiatorId:null,ruleForm:{},identycode:null,handleForm:[],items:[{message:"Foo",show:!1,id:1},{message:"Bar",show:!1,id:2}],fromuserid:null}},mounted(){this.identycode=localStorage.getItem("identityCode"),this.currentUserId=localStorage.getItem("currentUserId")},methods:{change(){this.$forceUpdate()},expo(){let t=p.Loading.service({fullscreen:!0});(0,h.ir)(this.ruleForm.rectifyId).then((t=>{var e=document.createElement("iframe");e.src=t.data.notificationExcel.objectUrl,e.style.display="none",document.body.appendChild(e);var a=document.createElement("iframe");a.src=t.data.confirmationExcel.objectUrl,a.style.display="none",document.body.appendChild(a)})),t.close()}},watch:{havedatainfo(t){(0,h.Bd)(t.rectifyId).then((t=>{this.ruleForm=t.data,this.fromuserid=t.data.processorId,this.initiatorId=t.data.initiatorId;let e=[],a=this.ruleForm.problems.length;for(let i=0;i<a;i++)e.push({advice:"",attachments:[],images:[]});this.handleForm=e}))}}},v=m,y=a(3736),g=(0,y.Z)(v,u,f,!1,null,"386a8a00",null),_=g.exports,x={components:{Titles:d["default"],Showdilog:_},filters:{time(t){const e=new Date(t),a=e.getFullYear(),i=(e.getMonth()+1+"").padStart(2,"0"),r=(e.getDay()+"").padStart(2,"0");(e.getHours()+"").padStart(2,"0"),(e.getMinutes()+"").padStart(2,"0"),(e.getSeconds()+"").padStart(2,"0");return`${a}-${i}-${r} `}},data(){return{activeName:"first",lidatas:[],total:null,currentPage:1,indx:"",charts:"",opinionData:[],havedatainfo:null}},mounted(){n({limit:4,offset:0,dataType:1}).then((t=>{this.lidatas=t.data.items,this.total=t.data.total})),this.$nextTick((()=>{c({dataType:1}).then((t=>{this.echartsInit(t.data,this.$refs.chartthree)})),l({dataType:1}).then((t=>{this.echartsInit(t.data,this.$refs.chartfour)})),o({dataType:1}).then((t=>{this.drawLine(this.$refs.chart,t.data.xaxis,t.data.yaxis)}))}))},methods:{liclick(t){this.havedatainfo=t,this.$store.state.safedilog=!0},handleClick(t){this.indx=t.index,n({limit:4,offset:0,dataType:Number(this.indx)+1}).then((t=>{this.lidatas=t.data.items,this.total=t.data.total,this.currentPage=1})),"0"==t.index?(c({dataType:1}).then((t=>{this.echartsInit(t.data,this.$refs.chartthree)})),l({dataType:1}).then((t=>{this.echartsInit(t.data,this.$refs.chartfour)})),o({dataType:1}).then((t=>{this.drawLine(this.$refs.chart,t.data.xaxis,t.data.yaxis)}))):(o({dataType:2}).then((t=>{this.drawLine(this.$refs.echartto,t.data.xaxis,t.data.yaxis)})),c({dataType:2}).then((t=>{this.echartsInit(t.data,this.$refs.echarttotop)})))},whatepage(t){n({limit:4,offset:4*(t-1),dataType:Number(this.indx)+1}).then((t=>{this.lidatas=t.data.items,this.total=t.data.total}))},echartsInit(t,e){let a=this.$echarts.getInstanceByDom(e);null==a&&(a=this.$echarts.init(e,null,{devicePixelRatio:2.5}));var i=[],r=0;for(var s in t.yaxisSeries){var n=["#009efd","#FFB140"],o={data:t.yaxisSeries[s],type:"bar",barWidth:"50%",name:"",itemStyle:{color:n[r]},showBackground:!0,lineStyle:{type:"dashed"}};i.push(o),r++}a.setOption({backgroundColor:"",title:[],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:{type:"category",data:t.xaxis,axisLabel:{color:"#fff",fontSize:"10px",interval:0,rotate:"60",formatter:function(t){var e="",a=8,i=t.length,r=Math.ceil(i/a);if(r>1){for(var s=0;s<r;s++){var n="",o=s*a,c=o+a;n=t.substring(o,c)+"\n",e+=n}return e}return t}},axisLine:{lineStyle:{type:"solid",color:"#ccc"}}},grid:{top:"18%",right:"2%",left:"2%",bottom:"0",containLabel:!0},yAxis:{type:"value",color:"#fff",name:"(个)",nameTextStyle:{color:"#fff"},axisLine:{lineStyle:{type:"solid",color:"#ccc"}},splitNumber:"3",axisLabel:{color:"#fff",fontSize:"10px"},splitLine:{show:!0,lineStyle:{type:"dashed",color:"#555"}}},series:i}),window.addEventListener("resize",(function(){a.resize(),a.resize(),a.resize()}))},drawLine(t,e,a){this.charts=this.$echarts.init(t,null,{devicePixelRatio:2.5}),this.charts.setOption({grid:{show:!0,top:"18%",right:"5%",left:"5%",bottom:"15%",borderColor:"transparent",backgroundColor:"rgba(128, 128, 128, 0.1)"},tooltip:{trigger:"axis",show:!0,appendToBody:!0},xAxis:{type:"category",data:e,axisLabel:{textStyle:{fontSize:"12",color:"#fff",textaline:"center"}}},yAxis:{type:"value",name:"（个）",nameTextStyle:{color:"#fff"},splitLine:{show:!0,lineStyle:{type:"dashed",color:"#8990aa"}},axisLabel:{textStyle:{fontSize:"12",color:"#fff"}}},series:[{type:"line",data:a,itemStyle:{backgroundColor:"#6eaaee"}}]}),window.onresize=this.charts.resize}}},b=x,w=(0,y.Z)(b,i,r,!1,null,"3a1f12a8",null),k=w.exports},1594:function(){},7578:function(t,e,a){"use strict";a.d(e,{Bd:function(){return f},DO:function(){return r},E:function(){return g},In:function(){return d},Iv:function(){return v},OY:function(){return h},Pu:function(){return n},dZ:function(){return u},ir:function(){return m},j3:function(){return _},lE:function(){return c},lG:function(){return y},qR:function(){return o},sw:function(){return l},tO:function(){return s},vQ:function(){return p}});var i=a(4471);function r(t){return(0,i.Z)({url:"rectifies/v2/pending/actions/search",method:"get",params:{limit:8,offset:8*(t.page-1),status:t.status,keyword:t.keyword}})}function s(t){return(0,i.Z)({url:"rectifies/v2/initiate/actions/search",method:"get",params:{limit:8,offset:8*(t.page-1),status:t.status,keyword:t.keyword}})}function n(t){return(0,i.Z)({url:"/rectifies/v2/userRelated/actions/search",method:"get",params:{limit:8,offset:8*(t.page-1),status:t.status,keyword:t.keyword}})}function o(t){return(0,i.Z)({url:"v1/section/section/search",method:"get"})}function c(t){return(0,i.Z)({url:"accounts/v1/departments/"+t+"/users",method:"get"})}function l(t){return(0,i.Z)({url:"rectifies/v2",method:"post",data:t})}function d(t){return(0,i.Z)({url:"rectifies/v2/actions/saveAsDraft",method:"post",data:t})}function u(t){return(0,i.Z)({url:"/rectifies/v2/"+t.rectifyId+"/draft/actions/convertFormal",method:"put",data:t})}function f(t){return(0,i.Z)({url:"rectifies/v2/"+t,method:"get"})}function h(t){return(0,i.Z)({url:"/rectifies/v2/"+t.rectifyId,method:"put",data:t})}function p(t){return(0,i.Z)({url:"/rectifies/v2/"+t,method:"DELETE"})}function m(t){return(0,i.Z)({url:"/rectifies/v2/"+t+"/actions/exportExcel",method:"get"})}function v(t){return(0,i.Z)({url:"/rectifies/v2/"+t+"/actions/revoke",method:"post"})}function y(t){return(0,i.Z)({url:"/rectifies/v2/"+t.rectifyId+"/problems/"+t.problemId,method:"put",data:t.data})}function g(t){return(0,i.Z)({url:"/rectifies/v2/problems/"+t.id+"/actions/handle",method:"post",data:t.from})}function _(t){return(0,i.Z)({url:"/rectifies/v2/"+t.rectifyId+"/problems/"+t.problemId+"/actions/approve",method:"post",data:t.data})}},2276:function(t,e,a){"use strict";t.exports=a.p+"static/img/moren.f41cf79b.png"}}]);
//# sourceMappingURL=509.afaa72bf.js.map