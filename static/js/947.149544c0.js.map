{"version":3,"file":"static/js/947.149544c0.js","mappings":"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","sources":["webpack://front-vue/./src/views/Login.vue","webpack://front-vue/src/views/Login.vue","webpack://front-vue/./src/views/Login.vue?24ab","webpack://front-vue/./src/views/Login.vue?9f01","webpack://front-vue/./src/utils/comm.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{attrs:{\"id\":\"login\"}},[_c('div',{staticClass:\"loginbox\"},[_c('h3',[_vm._v(\"智慧工地管理平台登录\")]),_c('el-form',{ref:\"ruleForm\",staticClass:\"demo-ruleForm\",attrs:{\"model\":_vm.ruleForm,\"rules\":_vm.rules},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.submitForm('ruleForm')}}},[_c('el-form-item',{attrs:{\"prop\":\"userName\"}},[_c('el-input',{attrs:{\"placeholder\":\"用户名\"},model:{value:(_vm.ruleForm.userName),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"userName\", _vm._n($$v))},expression:\"ruleForm.userName\"}},[_c('template',{slot:\"prepend\"},[_c('i',{staticClass:\"el-icon-user\"})])],2)],1),_c('el-form-item',{attrs:{\"prop\":\"password\"}},[_c('el-input',{attrs:{\"type\":\"password\",\"placeholder\":\"密码\"},model:{value:(_vm.ruleForm.password),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"password\", $$v)},expression:\"ruleForm.password\"}},[_c('template',{slot:\"prepend\"},[_c('i',{staticClass:\"el-icon-lock\"})])],2)],1),_c('el-form-item',{staticClass:\"btnbox\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.submitForm('ruleForm')}}},[_vm._v(\"登录\")])],1)],1)],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n\t<div id=\"login\">\r\n\t\t   <div class=\"loginbox\">\r\n\t\t\t   <h3>智慧工地管理平台登录</h3>\r\n\t\t\t   <el-form :model=\"ruleForm\"  :rules=\"rules\" ref=\"ruleForm\"  class=\"demo-ruleForm\"  @keyup.enter.native=\"submitForm('ruleForm')\">\r\n\t\t\t\t   <el-form-item prop=\"userName\">\r\n\t\t\t\t     <el-input v-model.number=\"ruleForm.userName\" placeholder=\"用户名\">\r\n\t\t\t\t\t\t  <template slot=\"prepend\"><i class=\"el-icon-user\"></i></template>\r\n\t\t\t\t\t </el-input>\r\n\t\t\t\t   </el-form-item>\r\n\t\t\t     <el-form-item prop=\"password\">\r\n\t\t\t       <el-input type=\"password\" v-model=\"ruleForm.password\"  placeholder=\"密码\">\r\n\t\t\t\t\t    <template slot=\"prepend\"><i class=\"el-icon-lock\"></i></template>\r\n\t\t\t\t   </el-input>\r\n\t\t\t     </el-form-item>\r\n\t\t\t    \r\n\t\t\t     <el-form-item class=\"btnbox\">\r\n\t\t\t       <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">登录</el-button>\r\n\t\t\t     </el-form-item>\r\n\t\t\t   </el-form>\r\n\t\t   </div>\r\n\t\t  </div>\n</template>\n\n<script>\r\n\timport {login,getUserInfo,news} from '@/utils/comm.js'\r\n\timport wx from \"weixin-js-sdk\"\r\n\t  export default {\r\n\t\t  inject:[\"reload\"],\r\n\t    data() {\r\n\t      var checkAge = (rule, value, callback) => {\r\n\t        if (value === '') {\r\n\t          return callback(new Error('用户名不能为空'));\r\n\t        }else {\n\t\t\tcallback();\n\t\t}\r\n\t      };\r\n\t      var validatePass = (rule, value, callback) => {\r\n\t        if (value === '') {\r\n\t          callback(new Error('请输入密码'));\r\n\t        } else {\n\t\t\tcallback();\n\t\t\t}\r\n\t      };\r\n\t      return {\r\n\t        ruleForm: {\r\n\t          password: '',\r\n\t          userName: '',\r\n\t\t\t  uuid: 'UUID'\r\n\t        },\r\n\t        rules: {\r\n\t          password: [\r\n\t            { validator: validatePass, trigger: 'blur' }\r\n\t          ],\r\n\t          userName: [\r\n\t            { validator: checkAge, trigger: 'blur' }\r\n\t          ]\r\n\t        }\r\n\t      };\r\n\t    },\r\n\t\tmounted(){\r\n\t\t\t// let ua = window.navigator.userAgent.toLowerCase();\r\n\t\t\t// let that = this;\r\n\t\t\t// if (ua.match(/MicroMessenger/i) == \"micromessenger\") {\r\n\t\t\t//   //微信环境下\r\n\t\t\t//   wx.miniProgram.getEnv(function (res) {\r\n\t\t\t// \tif (res.miniprogram) {\r\n\t\t\t// \t\talert(\"that.$route.query.expireTime\")\r\n\t\t\t// \t  // 小程序环境下逻辑\r\n\t\t\t// \t  localStorage.setItem('tocken','Bearer '+ that.$route.query.token)\r\n\t\t\t// \t  localStorage.setItem('expireTime',that.$route.query.expireTime)\r\n\t\t\t// \t  that.$router.push('/bim/index')\r\n\t\t\t// \t  alert(that.$route.query.expireTime)\r\n\t\t\t// \t} \r\n\t\t\t//   })\r\n\t\t\t// }\r\n\t\t},\r\n\t    methods: {\r\n\t      submitForm(formName) {\r\n\t        this.$refs[formName].validate((valid) => {\r\n\t          if (valid) {\r\n\t           login(this.ruleForm).then(res=>{\r\n\t\t\t\t   if(res.data.code == 200){\r\n\t\t\t\t\t   localStorage.setItem('username',this.ruleForm.userName)\r\n\t\t\t\t\t   localStorage.setItem('tocken','Bearer '+res.data.data.token)\r\n\t\t\t\t\t   localStorage.setItem('expireTime',res.data.data.expireTime)\r\n\t\t\t\t\t   this.$nextTick(()=>{\r\n\t\t\t\t\t   \tgetUserInfo().then(info=>{\r\n\t\t\t\t\t   \t\tlocalStorage.setItem('identityCode',info.data.identityCode)\r\n\t\t\t\t\t   \t\tlocalStorage.setItem('currentUserId',info.data.userId)\r\n\t\t\t\t\t\t\tthis.$message.success('登录成功')\r\n\t\t\t\t\t\t\tthis.$router.push('/home')\r\n\t\t\t\t\t   \t})\r\n\t\t\t\t\t\tnews({status:0}).then(ress=>{\r\n\t\t\t\t\t\t\tlocalStorage.setItem('newstotal',ress.total)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t   })\r\n\t\t\t\t   }else{\r\n\t\t\t\t\t   this.$message.error(res.data.data.detail)\r\n\t\t\t\t   }\r\n\t\t\t   })\r\n\t          } else {\r\n\t            console.log('error submit!!');\r\n\t            return false;\r\n\t          }\r\n\t        })\r\n\t      }\r\n\t    }\r\n\t  }\n</script>\n\n<style scoped>\r\n\t.loginbox{\r\n\t\twidth: 28%;\r\n\t\theight: 317px;\r\n\t\tbackground: rgba(255,255,255,0.9);\r\n\t\tmin-width: 300px;\r\n\t\tmax-width: 600px;\r\n\t\tpadding:30px 40px 40px 40px;\r\n\t\tbox-sizing: border-box;\r\n\t\tborder-radius: 10px;\r\n\t\tposition: fixed;\r\n\t\ttop: calc(50% - 158.5px);\r\n\t\tleft:calc(50% - 16.7%);\r\n\t}\r\n\t.loginbox h3{\r\n\t\ttext-align: center;\r\n\t\tmargin-bottom: 40px;\r\n\t}\r\n\t.btnbox{text-align: center;}\r\n\t/deep/.el-form-item__error{\r\n\t\tleft: 70px;\r\n\t}\n</style>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=959f0c54&scoped=true&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Login.vue?vue&type=style&index=0&id=959f0c54&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"959f0c54\",\n  null\n  \n)\n\nexport default component.exports","import axios from 'axios'\r\nimport request from '@/utils/request.js'\r\n\r\n//登录\r\nexport function login (data){\r\n\treturn axios({\r\n\t\turl:process.env.VUE_APP_BASE_API + '/accounts/v1/actions/loginByPassword',\r\n\t\tmethod:'post',\r\n\t\tdata:data\r\n\t})\r\n}\r\n\r\n// 身份信息\r\nexport function getUserInfo(){\r\n\treturn request({\r\n\t\turl:'/accounts/v1/users',\r\n\t\tmethod:'get'\r\n\t})\r\n}\r\n// 修改密码\r\nexport function reserpwd(data){\r\n\treturn request({\r\n\t\turl:'/accounts/v1/updatePwd',\r\n\t\tmethod:'put',\r\n\t\tparams:data\r\n\t})\r\n}\r\n// 菜单栏消息\r\nexport function news(data){\r\n\treturn request({\r\n\t\turl:'/front/v1/msg/list',\r\n\t\tmethod:'get',\r\n\t\tparams:data\r\n\t})\r\n}\r\n\r\n// 菜单栏消息已读\r\nexport function ready(data){\r\n\treturn request({\r\n\t\turl:'front/v1/msg/read',\r\n\t\tmethod:'get',\r\n\t\tparams:{\r\n\t\t\tmsgId:data\r\n\t\t}\r\n\t})\r\n}"],"names":["render","_vm","this","_c","_self","attrs","staticClass","_v","ref","ruleForm","rules","nativeOn","$event","type","indexOf","_k","keyCode","key","submitForm","model","value","userName","callback","$$v","$set","_n","expression","slot","password","on","staticRenderFns","inject","data","checkAge","rule","Error","validatePass","uuid","validator","trigger","mounted","methods","formName","$refs","validate","valid","console","log","login","then","res","code","localStorage","setItem","token","expireTime","$nextTick","getUserInfo","info","identityCode","userId","$message","success","$router","push","news","status","ress","total","error","detail","component","axios","url","process","method","request","reserpwd","params","ready","msgId"],"sourceRoot":""}